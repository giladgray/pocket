(function() {
  var MAX_FUEL, bestScore, canvas, distance, highscoreEl, mouse, mouseFuel, newBall, pocket, random, score, scoreEl, scoreOne, scoreZero, start;

  random = function(min, max) {
    if (max == null) {
      max = min;
      min = 0;
    }
    return Math.floor(Math.random() * (max - min)) + min;
  };

  distance = function(a, b) {
    var dx, dy;
    dx = a.x - b.x;
    dy = a.y - b.y;
    return Math.sqrt(dx * dx + dy * dy);
  };

  pocket = new Pocket;

  pocket.component('context-2d', function(cmp, _arg) {
    var canvas, resize;
    canvas = _arg.canvas;
    cmp.canvas = document.querySelector(canvas || '#canvas');
    cmp.g2d = cmp.canvas.getContext('2d');
    cmp.center = {
      x: 0,
      y: 0
    };
    window.addEventListener('resize', resize = function() {
      cmp.canvas.width = document.body.clientWidth;
      cmp.canvas.height = document.body.clientHeight;
      cmp.width = cmp.canvas.width;
      return cmp.height = cmp.canvas.height;
    });
    return resize();
  });

  pocket.key({
    'context-2d': {
      width: 'auto',
      height: 'auto'
    }
  });

  canvas = pocket.getData('context-2d');

  pocket.component('mouse-state', function(cmp, _arg) {
    var origin, target, _ref, _ref1;
    target = _arg.target, origin = _arg.origin;
    if (origin == null) {
      origin = {};
    }
    cmp.origin = {
      x: (_ref = origin.x) != null ? _ref : 0,
      y: (_ref1 = origin.y) != null ? _ref1 : 0
    };
    cmp.target = typeof target === 'string' ? document.querySelector(target) : document.body;
    cmp.buttons = {
      left: false,
      middle: false,
      right: false
    };
    cmp.cursor = {
      x: null,
      y: null
    };
    cmp.inWindow = true;
    cmp.target.addEventListener('mousemove', function(e) {
      cmp.cursor.x = e.clientX - cmp.origin.x;
      return cmp.cursor.y = e.clientY - cmp.origin.x;
    });
    cmp.target.addEventListener('mousedown', function(e) {
      if (e.which === 1) {
        cmp.buttons.left = true;
      }
      if (e.which === 2) {
        cmp.buttons.middle = true;
      }
      if (e.which === 3) {
        return cmp.buttons.right = true;
      }
    });
    cmp.target.addEventListener('mouseup', function(e) {
      if (e.which === 1) {
        cmp.buttons.left = false;
      }
      if (e.which === 2) {
        cmp.buttons.middle = false;
      }
      if (e.which === 3) {
        return cmp.buttons.right = false;
      }
    });
    cmp.target.addEventListener('mouseenter', function(e) {
      return cmp.inWindow = true;
    });
    return cmp.target.addEventListener('mouseleave', function(e) {
      return cmp.inWindow = false;
    });
  });

  pocket.key({
    'mouse-state': null
  });

  mouse = pocket.getData('mouse-state');

  pocket.component('position', {
    x: 0,
    y: 0
  });

  pocket.component('velocity', {
    x: 0,
    y: 0
  });

  pocket.component('circle', {
    radius: 30,
    color: 'cornflowerblue'
  });

  MAX_FUEL = 5000;

  mouseFuel = 0;

  newBall = function() {
    mouseFuel = MAX_FUEL;
    return pocket.key({
      position: {
        x: random(canvas.width),
        y: random(canvas.height)
      },
      velocity: {
        speed: 0
      },
      circle: null
    });
  };

  newBall();

  pocket.systemForEach('move-ball', ['position', 'velocity'], function(pocket, key, pos, vel) {
    var angle;
    if (!mouse.inWindow) {
      return;
    }
    angle = Math.atan2(mouse.cursor.y - pos.y, mouse.cursor.x - pos.x);
    vel.x = vel.speed * Math.cos(angle);
    vel.y = vel.speed * Math.sin(angle);
    if (mouse.buttons.left && mouseFuel > 0) {
      vel.x *= -1 / 4;
      vel.y *= -1 / 4;
      mouseFuel -= pocket.delta;
    } else {
      vel.speed += 1 / 20;
      mouseFuel += pocket.delta / 3;
      mouseFuel = Math.min(mouseFuel, MAX_FUEL);
    }
    pos.x += vel.x;
    return pos.y += vel.y;
  });

  pocket.systemForEach('respawn-ball', ['position', 'circle'], function(pocket, key, pos, _arg) {
    var radius;
    radius = _arg.radius;
    if (distance(mouse.cursor, pos) < radius) {
      pocket.destroyKey(key);
      scoreZero();
      return newBall();
    }
  });

  pocket.system('clear-canvas', [], function(pocket) {
    var g2d, height, width;
    g2d = canvas.g2d, width = canvas.width, height = canvas.height;
    return g2d.clearRect(0, 0, width, height);
  });

  pocket.systemForEach('draw-ball', ['position', 'circle'], function(pocket, key, pos, circle) {
    var g2d;
    g2d = canvas.g2d;
    g2d.beginPath();
    g2d.fillStyle = circle.color;
    g2d.arc(pos.x, pos.y, circle.radius, 0, Math.PI * 2);
    g2d.closePath();
    return g2d.fill();
  });

  pocket.system('draw-fuel', [], function(pocket) {
    var g2d, height, width;
    g2d = canvas.g2d, width = canvas.width, height = canvas.height;
    g2d.beginPath();
    g2d.fillStyle = 'orange';
    g2d.fillRect(0, height - 30, mouseFuel / MAX_FUEL * width, 30);
    return g2d.closePath();
  });

  score = 0;

  bestScore = 0;

  scoreEl = document.querySelector('.scores .current');

  highscoreEl = document.querySelector('.scores .best');

  scoreOne = function(amt) {
    if (amt == null) {
      amt = 1;
    }
    return scoreEl.textContent = score += amt;
  };

  scoreZero = function() {
    if (score > bestScore) {
      highscoreEl.textContent = bestScore = score;
    }
    return scoreEl.textContent = score = 0;
  };

  pocket.system('update-score', [], function(pocket) {
    if (!mouse.inWindow) {
      return;
    }
    return scoreOne(Math.floor(pocket.delta || 0));
  });

  start = function(time) {
    pocket.tick(time);
    return window.requestAnimationFrame(start);
  };

  document.addEventListener('DOMContentLoaded', function() {
    return start();
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vdXNlbWFuL21vdXNlbWFuLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBLE1BQUEseUlBQUE7O0FBQUEsRUFBQSxNQUFBLEdBQVMsU0FBQyxHQUFELEVBQU0sR0FBTixHQUFBO0FBQ1AsSUFBQSxJQUFPLFdBQVA7QUFDRSxNQUFBLEdBQUEsR0FBTSxHQUFOLENBQUE7QUFBQSxNQUNBLEdBQUEsR0FBTSxDQUROLENBREY7S0FBQTtBQUdBLFdBQU8sSUFBSSxDQUFDLEtBQUwsQ0FBVyxJQUFJLENBQUMsTUFBTCxDQUFBLENBQUEsR0FBZ0IsQ0FBQyxHQUFBLEdBQU0sR0FBUCxDQUEzQixDQUFBLEdBQTBDLEdBQWpELENBSk87RUFBQSxDQUFULENBQUE7O0FBQUEsRUFNQSxRQUFBLEdBQVcsU0FBQyxDQUFELEVBQUksQ0FBSixHQUFBO0FBQ1QsUUFBQSxNQUFBO0FBQUEsSUFBQSxFQUFBLEdBQUssQ0FBQyxDQUFDLENBQUYsR0FBTSxDQUFDLENBQUMsQ0FBYixDQUFBO0FBQUEsSUFDQSxFQUFBLEdBQUssQ0FBQyxDQUFDLENBQUYsR0FBTSxDQUFDLENBQUMsQ0FEYixDQUFBO1dBRUEsSUFBSSxDQUFDLElBQUwsQ0FBVSxFQUFBLEdBQUssRUFBTCxHQUFVLEVBQUEsR0FBSyxFQUF6QixFQUhTO0VBQUEsQ0FOWCxDQUFBOztBQUFBLEVBV0EsTUFBQSxHQUFTLEdBQUEsQ0FBQSxNQVhULENBQUE7O0FBQUEsRUFjQSxNQUFNLENBQUMsU0FBUCxDQUFpQixZQUFqQixFQUErQixTQUFDLEdBQUQsRUFBTSxJQUFOLEdBQUE7QUFDN0IsUUFBQSxjQUFBO0FBQUEsSUFEb0MsU0FBRCxLQUFDLE1BQ3BDLENBQUE7QUFBQSxJQUFBLEdBQUcsQ0FBQyxNQUFKLEdBQWEsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsTUFBQSxJQUFVLFNBQWpDLENBQWIsQ0FBQTtBQUFBLElBQ0EsR0FBRyxDQUFDLEdBQUosR0FBVSxHQUFHLENBQUMsTUFBTSxDQUFDLFVB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QUNWLElBQUEsSUFBRyxLQUFBLEdBQVEsU0FBWDtBQUNFLE1BQUEsV0FBVyxDQUFDLFdBQVosR0FBMEIsU0FBQSxHQUFZLEtBQXRDLENBREY7S0FBQTtXQUVBLE9BQU8sQ0FBQyxXQUFSLEdBQXNCLEtBQUEsR0FBUSxFQUhwQjtFQUFBLENBaEpaLENBQUE7O0FBQUEsRUFxSkEsTUFBTSxDQUFDLE1BQVAsQ0FBYyxjQUFkLEVBQThCLEVBQTlCLEVBQWtDLFNBQUMsTUFBRCxHQUFBO0FBQ2hDLElBQUEsSUFBQSxDQUFBLEtBQW1CLENBQUMsUUFBcEI7QUFBQSxZQUFBLENBQUE7S0FBQTtXQUNBLFFBQUEsQ0FBUyxJQUFJLENBQUMsS0FBTCxDQUFXLE1BQU0sQ0FBQyxLQUFQLElBQWdCLENBQTNCLENBQVQsRUFGZ0M7RUFBQSxDQUFsQyxDQXJKQSxDQUFBOztBQUFBLEVBMEpBLEtBQUEsR0FBUSxTQUFDLElBQUQsR0FBQTtBQUNOLElBQUEsTUFBTSxDQUFDLElBQVAsQ0FBWSxJQUFaLENBQUEsQ0FBQTtXQUNBLE1BQU0sQ0FBQyxxQkFBUCxDQUE2QixLQUE3QixFQUZNO0VBQUEsQ0ExSlIsQ0FBQTs7QUFBQSxFQThKQSxRQUFRLENBQUMsZ0JBQVQsQ0FBMEIsa0JBQTFCLEVBQThDLFNBQUEsR0FBQTtXQUFHLEtBQUEsQ0FBQSxFQUFIO0VBQUEsQ0FBOUMsQ0E5SkEsQ0FBQTtBQUFBIiwiZmlsZSI6Im1vdXNlbWFuL21vdXNlbWFuLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsicmFuZG9tID0gKG1pbiwgbWF4KSAtPlxuICB1bmxlc3MgbWF4P1xuICAgIG1heCA9IG1pblxuICAgIG1pbiA9IDBcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pKSArIG1pblxuXG5kaXN0YW5jZSA9IChhLCBiKSAtPlxuICBkeCA9IGEueCAtIGIueFxuICBkeSA9IGEueSAtIGIueVxuICBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpXG5cbnBvY2tldCA9IG5ldyBQb2NrZXRcblxuIyBjb250ZXh0LTJkIGNvbXBvbmVudCBmb3Igc3RvcmluZyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQgYW5kIG90aGVyIGNhbnZhcyBpbmZvXG5wb2NrZXQuY29tcG9uZW50ICdjb250ZXh0LTJkJywgKGNtcCwge2NhbnZhc30pIC0+XG4gIGNtcC5jYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yIGNhbnZhcyBvciAnI2NhbnZhcydcbiAgY21wLmcyZCA9IGNtcC5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxuICBjbXAuY2VudGVyID0ge3g6IDAsIHk6IDB9XG5cbiAgIyBlbnN1cmUgY2FudmFzIGlzIGFzIGxhcmdlIGFzIHBvc3NpYmxlXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICdyZXNpemUnLCByZXNpemUgPSAtPlxuICAgIGNtcC5jYW52YXMud2lkdGggPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoXG4gICAgY21wLmNhbnZhcy5oZWlnaHQgPSBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodFxuICAgIGNtcC53aWR0aCA9IGNtcC5jYW52YXMud2lkdGhcbiAgICBjbXAuaGVpZ2h0ID0gY21wLmNhbnZhcy5oZWlnaHRcbiAgcmVzaXplKClcblxuIyB0aGUgY29udGV4dC0yZCBkYXRhIG9iamVjdFxucG9ja2V0LmtleVxuICAnY29udGV4dC0yZCc6XG4gICAgd2lkdGg6ICdhdXRvJ1xuICAgIGhlaWdodDogJ2F1dG8nXG5jYW52YXMgPSBwb2NrZXQuZ2V0RGF0YSAnY29udGV4dC0yZCdcblxucG9ja2V0LmNvbXBvbmVudCAnbW91c2Utc3RhdGUnLCAoY21wLCB7dGFyZ2V0LCBvcmlnaW59KSAtPlxuICAjIHBvaW50IHRvIHdoaWNoIG1vdXNlIGNvb3JkaW5hdGVzIGFyZSByZWxhdGl2ZVxuICBvcmlnaW4gPz0ge31cbiAgY21wLm9yaWdpbiA9IHt4OiBvcmlnaW4ueCA/IDAsIHk6IG9yaWdpbi55ID8gMH1cbiAgIyByZW1lbWJlciB0aGUgdGFyZ2V0XG4gIGNtcC50YXJnZXQgPSBpZiB0eXBlb2YgdGFyZ2V0IGlzICdzdHJpbmcnIHRoZW4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpIGVsc2UgZG9jdW1lbnQuYm9keVxuICAjIGN1cnJlbnQgYnV0dG9uIHN0YXRlLCBieSBuYW1lXG4gIGNtcC5idXR0b25zID1cbiAgICBsZWZ0ICAgOiBmYWxzZVxuICAgIG1pZGRsZSA6IGZhbHNlXG4gICAgcmlnaHQgIDogZmFsc2VcbiAgIyBjdXJyZW50IGN1cnNvciBwb3NpdGlvblxuICBjbXAuY3Vyc29yID1cbiAgICB4OiBudWxsXG4gICAgeTogbnVsbFxuICAjIHdoZXRoZXIgbW91c2UgaXMgY3VycmVudGx5IGluIHRoZSB3aW5kb3dcbiAgY21wLmluV2luZG93ID0gdHJ1ZVxuXG4gICMgYW5kIG5vdyB0aGUgbGlzdGVuZXJzLi4uXG4gIGNtcC50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lciAnbW91c2Vtb3ZlJywgKGUpIC0+XG4gICAgIyB1cGRhdGUgbW91c2UgY3Vyc29yIHJlbGF0aXZlIHRvIG9yaWdpblxuICAgIGNtcC5jdXJzb3IueCA9IGUuY2xpZW50WCAtIGNtcC5vcmlnaW4ueFxuICAgIGNtcC5jdXJzb3IueSA9IGUuY2xpZW50WSAtIGNtcC5vcmlnaW4ueFxuICBjbXAudGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIgJ21vdXNlZG93bicsIChlKSAtPlxuICAgICMgbWFya2VkIGJ1dHRvbiBhcyBwcmVzc2VkIGlmIGl0IGNhdXNlZCB0aGlzIGV2ZW50XG4gICAgY21wLmJ1dHRvbnMubGVmdCAgID0gdHJ1ZSBpZiBlLndoaWNoIGlzIDFcbiAgICBjbXAuYnV0dG9ucy5taWRkbGUgPSB0cnVlIGlmIGUud2hpY2ggaXMgMlxuICAgIGNtcC5idXR0b25zLnJpZ2h0ICA9IHRydWUgaWYgZS53aGljaCBpcyAzXG4gIGNtcC50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lciAnbW91c2V1cCcsIChlKSAtPlxuICAgICMgdW5tYXJrIHByZXNzZWQgYnV0dG9uIGlmIGl0IGNhdXNlZCB0aGlzIGV2ZW50XG4gICAgY21wLmJ1dHRvbnMubGVmdCAgID0gZmFsc2UgaWYgZS53aGljaCBpcyAxXG4gICAgY21wLmJ1dHRvbnMubWlkZGxlID0gZmFsc2UgaWYgZS53aGljaCBpcyAyXG4gICAgY21wLmJ1dHRvbnMucmlnaHQgID0gZmFsc2UgaWYgZS53aGljaCBpcyAzXG4gICMgdXBkYXRlIG1vdXNlIGluIHdpbmRvdyBzdGF0ZT9cbiAgY21wLnRhcmdldC5hZGRFdmVudExpc3RlbmVyICdtb3VzZWVudGVyJywgKGUpIC0+IGNtcC5pbldpbmRvdyA9IHRydWVcbiAgY21wLnRhcmdldC5hZGRFdmVudExpc3RlbmVyICdtb3VzZWxlYXZlJywgKGUpIC0+IGNtcC5pbldpbmRvdyA9IGZhbHNlXG5cbnBvY2tldC5rZXlcbiAgJ21vdXNlLXN0YXRlJzogbnVsbFxubW91c2UgPSBwb2NrZXQuZ2V0RGF0YSAnbW91c2Utc3RhdGUnXG5cbiMgZ2FtZSBjb21wb25lbnRzXG5wb2NrZXQuY29tcG9uZW50ICdwb3NpdGlvbicsIHt4OiAwLCB5OiAwfVxucG9ja2V0LmNvbXBvbmVudCAndmVsb2NpdHknLCB7eDogMCwgeTogMH1cbnBvY2tldC5jb21wb25lbnQgJ2NpcmNsZScsICAge3JhZGl1czogMzAsIGNvbG9yOiAnY29ybmZsb3dlcmJsdWUnfVxuXG5NQVhfRlVFTCAgPSA1MDAwXG5tb3VzZUZ1ZWwgPSAwXG5cbm5ld0JhbGwgPSAtPlxuICBtb3VzZUZ1ZWwgPSBNQVhfRlVFTFxuICBwb2NrZXQua2V5XG4gICAgcG9zaXRpb246XG4gICAgICB4OiByYW5kb20gY2FudmFzLndpZHRoXG4gICAgICB5OiByYW5kb20gY2FudmFzLmhlaWdodFxuICAgIHZlbG9jaXR5OlxuICAgICAgc3BlZWQ6IDBcbiAgICBjaXJjbGU6IG51bGxcbm5ld0JhbGwoKVxuXG5wb2NrZXQuc3lzdGVtRm9yRWFjaCAnbW92ZS1iYWxsJywgWydwb3NpdGlvbicsICd2ZWxvY2l0eSddLCAocG9ja2V0LCBrZXksIHBvcywgdmVsKSAtPlxuICByZXR1cm4gdW5sZXNzIG1vdXNlLmluV2luZG93XG4gIGFuZ2xlID0gTWF0aC5hdGFuMiBtb3VzZS5jdXJzb3IueSAtIHBvcy55LCBtb3VzZS5jdXJzb3IueCAtIHBvcy54XG4gIHZlbC54ID0gdmVsLnNwZWVkICogTWF0aC5jb3MoYW5nbGUpXG4gIHZlbC55ID0gdmVsLnNwZWVkICogTWF0aC5zaW4oYW5nbGUpXG4gIGlmIG1vdXNlLmJ1dHRvbnMubGVmdCBhbmQgbW91c2VGdWVsID4gMCBcbiAgICB2ZWwueCAqPSAtMSAvIDRcbiAgICB2ZWwueSAqPSAtMSAvIDRcbiAgICBtb3VzZUZ1ZWwgLT0gcG9ja2V0LmRlbHRhXG4gIGVsc2VcbiAgICB2ZWwuc3BlZWQgKz0gMSAvIDIwXG4gICAgbW91c2VGdWVsICs9IHBvY2tldC5kZWx0YSAvIDNcbiAgICBtb3VzZUZ1ZWwgPSBNYXRoLm1pbihtb3VzZUZ1ZWwsIE1BWF9GVUVMKVxuICBwb3MueCArPSB2ZWwueFxuICBwb3MueSArPSB2ZWwueVxuXG5wb2NrZXQuc3lzdGVtRm9yRWFjaCAncmVzcGF3bi1iYWxsJywgWydwb3NpdGlvbicsICdjaXJjbGUnXSwgKHBvY2tldCwga2V5LCBwb3MsIHtyYWRpdXN9KSAtPlxuICBpZiBkaXN0YW5jZShtb3VzZS5jdXJzb3IsIHBvcykgPCByYWRpdXNcbiAgICBwb2NrZXQuZGVzdHJveUtleSBrZXlcbiAgICBzY29yZVplcm8oKVxuICAgIG5ld0JhbGwoKVxuXG4jIGNsZWFyIHRoZSBjYW52YXMgZWFjaCBmcmFtZVxucG9ja2V0LnN5c3RlbSAnY2xlYXItY2FudmFzJywgW10sIChwb2NrZXQpIC0+XG4gIHtnMmQsIHdpZHRoLCBoZWlnaHR9ID0gY2FudmFzXG4gIGcyZC5jbGVhclJlY3QgMCwgMCwgd2lkdGgsIGhlaWdodFxuXG4jIGRyYXcgZWFjaCBiYWxsc1xucG9ja2V0LnN5c3RlbUZvckVhY2ggJ2RyYXctYmFsbCcsIFsncG9zaXRpb24nLCAnY2lyY2xlJ10sIChwb2NrZXQsIGtleSwgcG9zLCBjaXJjbGUpIC0+XG4gIHtnMmR9ID0gY2FudmFzXG4gIGcyZC5iZWdpblBhdGgoKVxuICBnMmQuZmlsbFN0eWxlID0gY2lyY2xlLmNvbG9yXG4gIGcyZC5hcmMgcG9zLngsIHBvcy55LCBjaXJjbGUucmFkaXVzLCAwLCBNYXRoLlBJICogMlxuICBnMmQuY2xvc2VQYXRoKClcbiAgZzJkLmZpbGwoKVxuXG4jIGRyYXcgZWFjaCBiYWxsc1xucG9ja2V0LnN5c3RlbSAnZHJhdy1mdWVsJywgW10sIChwb2NrZXQpIC0+XG4gIHtnMmQsIHdpZHRoLCBoZWlnaHR9ID0gY2FudmFzXG4gIGcyZC5iZWdpblBhdGgoKVxuICBnMmQuZmlsbFN0eWxlID0gJ29yYW5nZSdcbiAgZzJkLmZpbGxSZWN0IDAsIGhlaWdodCAtIDMwLCBtb3VzZUZ1ZWwgLyBNQVhfRlVFTCAqIHdpZHRoLCAzMFxuICBnMmQuY2xvc2VQYXRoKClcblxuc2NvcmUgPSAwXG5iZXN0U2NvcmUgPSAwXG5zY29yZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciAnLnNjb3JlcyAuY3VycmVudCdcbmhpZ2hzY29yZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciAnLnNjb3JlcyAuYmVzdCdcbnNjb3JlT25lID0gKGFtdCA9IDEpLT5cbiAgc2NvcmVFbC50ZXh0Q29udGVudCA9IHNjb3JlICs9IGFtdFxuc2NvcmVaZXJvID0gLT5cbiAgaWYgc2NvcmUgPiBiZXN0U2NvcmVcbiAgICBoaWdoc2NvcmVFbC50ZXh0Q29udGVudCA9IGJlc3RTY29yZSA9IHNjb3JlXG4gIHNjb3JlRWwudGV4dENvbnRlbnQgPSBzY29yZSA9IDBcblxucG9ja2V0LnN5c3RlbSAndXBkYXRlLXNjb3JlJywgW10sIChwb2NrZXQpIC0+XG4gIHJldHVybiB1bmxlc3MgbW91c2UuaW5XaW5kb3dcbiAgc2NvcmVPbmUgTWF0aC5mbG9vcihwb2NrZXQuZGVsdGEgb3IgMClcblxuIyByZW5kZXIgbG9vcFxuc3RhcnQgPSAodGltZSkgLT5cbiAgcG9ja2V0LnRpY2sodGltZSlcbiAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSBzdGFydFxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICdET01Db250ZW50TG9hZGVkJywgLT4gc3RhcnQoKVxuIl19